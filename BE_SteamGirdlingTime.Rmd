---
title: "BE_SteamGirdlingTime"
author: "Julie Raiguel"
date: "March 12, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Call necessary libraries
library(ggplot2)
library(car)
```


```{r}
#Read in csv file and delete empty columns
all_peas = read.csv(file = "./data/FinalDataPeas.csv", header = TRUE)

head(all_peas)
all_peas = all_peas[,-c(14:19)]
colnames(all_peas)
nrow(all_peas)

#Remove rows of samples eliminated because of mistakes in experiment
Sample = match("Smp",colnames(all_peas))

for(i in nrow(all_peas):1) {
    if(all_peas[i,Sample] == 90 | 
       all_peas[i,Sample] == 91 | 
       all_peas[i,Sample] == 177) {
          all_peas = all_peas[-i,]
    }
}

nrow(all_peas)
```

```{r}
#Order Treatments
all_peas$Trmt = factor(all_peas$Trmt, 
                       levels = c('L', '5', '10', '15', '20', 
                                  '30', '45', '60', '120', 'B'))

#Create Numeric Treatments Column for Regressions
all_peas$Time = ifelse(all_peas$Trmt == 'L', 0, ifelse(all_peas$Trmt == 'B', NA, as.numeric(as.character(all_peas$Trmt))))

head(all_peas)
```


```{r}
#Subset Data by Treatment
Trmt_5 = subset(all_peas, all_peas$Trmt == '5')
nrow(Trmt_5)

Trmt_10 = subset(all_peas, all_peas$Trmt == '10')
Trmt_15 = subset(all_peas, all_peas$Trmt == '15')
Trmt_20 = subset(all_peas, all_peas$Trmt == '20')
Trmt_30 = subset(all_peas, all_peas$Trmt == '30')
Trmt_45 = subset(all_peas, all_peas$Trmt == '45')
Trmt_60 = subset(all_peas, all_peas$Trmt == '60')
Trmt_120 = subset(all_peas, all_peas$Trmt == '120')
Trmt_L = subset(all_peas, all_peas$Trmt == 'L')
Trmt_B = subset(all_peas, all_peas$Trmt == 'B')
```

```{r}
#Plot all data by treatment
all_boxplot = plot(all_peas$Trmt, all_peas$Abs_Mass)
all_boxplot$out
```


```{r}
#Check to see if dividing out the mass caused increase in 45-120
plot(all_peas$Trmt, all_peas$Abs_Blk)
```

```{r}
#Subset data by Tap Roots and Lateral Roots
Diam_Tap = subset(all_peas, all_peas$Tap_Lat == "Tap")
Diam_Lat = subset(all_peas, all_peas$Tap_Lat == "Lat")

nrow(Diam_Tap)
nrow(Diam_Lat)
```

```{r}
#Plot Data by Taps and Lats
par(mfrow = c(1,2))
plot(Diam_Tap$Trmt, Diam_Tap$Abs_Mass, main = "Tap Roots", ylab = "Absorbance/Dry Mass")
plot(Diam_Lat$Trmt, Diam_Lat$Abs_Blk, main = "Lateral Roots", ylab = "Absorbance/Dry Mass")
```


```{r}
#Check normality of data to find it is skewed to the left
par(mfrow = c(2,5))

hist(Trmt_5$Abs_Mass, main = "5 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_10$Abs_Mass, main = "10 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_15$Abs_Mass, main = "15 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_20$Abs_Mass, main = "20 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_30$Abs_Mass, main = "30 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_45$Abs_Mass, main = "45 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_60$Abs_Mass, main = "60 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_120$Abs_Mass, main = "120 seconds", xlab = "Absorbance/Dry Mass")
hist(Trmt_L$Abs_Mass, main = "Live", xlab = "Absorbance/Dry Mass")
hist(Trmt_B$Abs_Mass, main = "Boiled", xlab = "Absorbance/Dry Mass")

```

```{r}
all_peas$Trmt = factor(all_peas$Trmt, levels = c('B', 'L', '5', '10', '15', '20', '30', '45', '60', '120'))
contrasts(all_peas$Trmt) 
all_trmt_model = lm(Abs_Mass ~ Trmt, data = all_peas)

summary(all_trmt_model)
Anova(all_trmt_model, type =3)

par(mfrow = c(2,2))
plot(all_trmt_model)
```

```{r}
all_peas$Trmt = factor(all_peas$Trmt, levels = c('B', 'L', '5', '10', '15', '20', '30', '45', '60', '120'))
contrasts(all_peas$Trmt) 
all_trmt_glm = glm(Abs_Mass ~ Trmt, data = all_peas, family = Gamma())

summary(all_trmt_glm)
Anova(all_trmt_glm, type =3)
```

```{r}
Diam_Lat$Trmt = factor(Diam_Lat$Trmt, levels = c('B', 'L', '5', '10', '15', '20', '30', '45', '60', '120'))
contrasts(Diam_Lat$Trmt) 
lat_trmt_model = lm(Abs_Mass ~ Trmt, data = Diam_Lat)

summary(lat_trmt_model)
Anova(lat_trmt_model, type =3)

par(mfrow = c(2,2))
plot(lat_trmt_model)
```

```{r}
#Check normality of data
hist(all_peas$Abs_Mass)

#Try regression model
all_time_gamma = glm(Abs_Mass ~ Time, data = all_peas, family = Gamma())
summary(all_time_gamma)
```

```{r}
all_time_binomial = glm(Abs_Mass ~ Time, data = all_peas, family = binomial())
summary(all_time_binomial)
```
```{r}
all_time_gaussian = glm(Abs_Mass ~ Time, data = all_peas, family = gaussian())
summary(all_time_gaussian)
```

```{r}
anova(all_time_gamma, all_time_gaussian, all_time_binomial)
```

```{r}
all_gamma_predict <- data.frame(Time=seq(0,120,5))
gamma_curve <- predict(all_time_gamma,newdata=all_gamma_predict,type="response")
plot(all_peas$Abs_Mass~ Time, data=all_peas)
lines(gamma_curve~Time, data = all_gamma_predict)
```


```{r}
#Check normality of lateral root data
hist(Diam_Lat$Abs_Mass)

#Try regression model on lateral roots only
lat_time_model = glm(Abs_Mass ~ Time, data = Diam_Lat, family = Gamma())
summary(lat_time_model)

```

```{r}
lat_gamma_predict <- data.frame(Time=seq(0,120,5))
gamma_curve_lat <- predict(lat_time_model,newdata=lat_gamma_predict,type="response")
plot(Diam_Lat$Abs_Mass~ Diam_Lat$Time)
lines(gamma_curve_lat~Time, data = lat_gamma_predict)
```

```{r}

```


```{r}
#Plot Absorbance by Diameter for each treatment
par(mfrow = c(2,5))
plot(Abs_Mass ~ Diam, data = Trmt_L, main = "Live", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_5, main = "5 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_10, main = "10 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_15, main = "15 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_20, main = "20 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_30, main = "30 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_45, main = "45 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_60, main = "60 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_120, main = "120 seconds", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")
plot(Abs_Mass ~ Diam, data = Trmt_B, main = "Boiled", xlab = "Diameter (mm)", ylab = "Absorbance/Dry Mass")

```


```{r}
ggplot(pea_data, aes(x=pea_data$Diam, y=pea_data$Abs_Mass, color=pea_data$Trmt)) + geom_point()
```


```{r}
ggplot(pea_data, aes(x=pea_data$Trmt, y=pea_data$Abs_Mass)) + geom_point() + geom_hline(yintercept = mean_boileds, size=1)
```

```{r}
ggplot(pea_data, aes(x=pea_data$Abs_Mass, fill=pea_data$Trmt)) + geom_histogram()

```


```{r}
par(mfrow = c(1,2))
ggplot(taps, aes(x=taps$Abs_Mass, fill=taps$Trmt)) + geom_histogram()
ggplot(lats, aes(x=lats$Abs_Mass, fill=lats$Trmt)) + geom_histogram()
```









